# Stores & shapes

Sentential is quite forward with a strong opinion that secrets and config should be stored outside of source control.

That being said Sentential also considers defining requirements for a given deployment to be of great importance.

By default, Sentential allows you to store environment variables, build arguments, and tags in a flat undefined k/v store (AWS SSM backed).

With one additional concept of Shapes we can imprint onto our k/v store a set of required, optional, documented, and deploy-time validated expectations.

> :point_up: Stores are unique to each [Partition](/examples/partition)

### Without shapes

<!-- tabs:start -->

#### **Args**

Key/Value pairs stored under `sntl args` will be made available to `docker build` as [build args](https://docs.docker.com/engine/reference/commandline/build/#build-arg).

```bash
> sntl args set githubtoken d13ab86a-a406-11ed-918e-0fb3af2a1540
> sntl args ls

  key           value       description   validation  
 ───────────────────────────────────────────────── 
  githubtoken   d13ab...    None          None        
```

#### **Envs**

Key/Value pairs stored under `sntl envs` will be made available in the deployed Lambda environment variables.

```bash
> sntl envs set db_hostname somegreatdb.hostname.net
> sntl envs ls

  key           value         description   validation  
 ───────────────────────────────────────────────── 
  db_hostname   somegre...    None          None        
```

#### **Tags**

Key/Value pairs stored under `sntl tags` will be used to tag all resources generated by `sntl deploy`.

```bash
> sntl tags set deployed today
> sntl tags ls

  key        value    description   validation  
 ───────────────────────────────────────────────── 
  deployed   today    None          None        
```

<!-- tabs:end -->

### With shapes

Overwrite your shapes.py file with the following...

```python
from sentential.lib.shapes import StoreModel

class Args(StoreModel):
    github_token: str
    git_commit: str
    git_user: str

class Envs(StoreModel):
    db_hostname: str
    db_port: int
    db_username: str

class Secrets(StoreModel):
    db_password: str

class Tags(StoreModel):
    deployed_by: str
    department: str
```

With each of the below stores, notice now that our key space has a schema with validations.

<!-- tabs:start -->

#### **Args**

Key/Value pairs stored under `sntl args` will be made available to `docker build` as [build args](https://docs.docker.com/engine/reference/commandline/build/#build-arg).

```bash
> sntl args ls

  key            value       description   validation  
 ─────────────────────────────────────────────────────────
  github_token   None        None          field required 
  git_commit     None        None          field required          
  git_user       None        None          field required  
```

#### **Envs**

Key/Value pairs stored under `sntl envs` will be made available in the deployed Lambda environment variables.

```bash
> sntl envs ls

  key           value    description   validation  
 ─────────────────────────────────────────────────────────
  db_hostname   None     None          field required         
  db_port       None     None          field required         
  db_username   None     None          field required         
```

#### **Secrets**

Key/Value pairs stored under `sntl secrets` will be made available in the deployed Lambda environment variables.

```bash
> sntl secrets ls

  key           value    description   validation  
 ─────────────────────────────────────────────────────────
  db_password   None     None          field required         
```

#### **Tags**

Key/Value pairs stored under `sntl tags` will be used to tag all resources generated by `sntl deploy`.

```bash
> sntl tags ls

  key           value   description   validation  
 ─────────────────────────────────────────────────────────
  deployed_by   None    None          field required         
  department    None    None          field required
```

<!-- tabs:end -->

Adding descriptions is currently left as an [exercise for the reader](https://docs.pydantic.dev/usage/schema/#field-customization).

### Cleanup

```bash
> sntl args clear
> sntl envs clear
> sntl secrets clear
> sntl tags clear
```

### Further reading

- [pydantic](https://docs.pydantic.dev)
- [validators](https://docs.pydantic.dev/usage/validators/)
