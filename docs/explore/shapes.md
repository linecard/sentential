# Stores & Shapes

Sentential is quite forward with a strong opinion that secrets and config should be stored outside of source control.

That being said Sentential also considers defining requirements for a given deployment to be of great importance.

By default, Sentential allows you to store environment variables, build arguments, and tags in a flat undefined k/v store (AWS SSM backed).

With one additional concept of Shapes we can imprint onto our k/v store a set of required, optional, documented, and deploy-time validated expectations.

> :point_up: Stores are unique to each [Partition](/examples/partition)

### Without Shapes

<!-- tabs:start -->

#### **Args**
Key/Value pairs stored under `sntl args` will be made available to docker build as [build args](https://docs.docker.com/engine/reference/commandline/build/#build-arg).

```shell
> sntl args write githubtoken d13ab86a-a406-11ed-918e-0fb3af2a1540
> sntl args read

  field         value                     
 ──────────────────────────────────────── 
  githubtoken   d13ab86a-a406-11ed-918e-0fb3af2a1540
```

#### **Envs**
Key/Value pairs stored under `sntl envs` will be made available in the deployed lambda environment variables.

```shell
> sntl envs write db_hostname somegreatdb.hostname.net
> sntl envs read

  field         value                     
 ──────────────────────────────────────── 
  db_hostname   somegreatdb.hostname.net 
```

#### **Tags**
Key/Value pairs stored under `sntl tags` will be used to tag all resources generated by `sntl deploy`.

```shell
> sntl tags write deployed today
> sntl tags read

  field      value  
 ────────────────── 
  deployed   today  
```

<!-- tabs:end -->

### With Shapes

Overwrite your shapes.py file with the following...

```python
from sentential.support.shaper import Shaper, List, Field

class Envs(Shaper):
    db_hostname: str
    db_port: int
    db_username: str
    db_password: str

class Args(Shaper):
    github_token: str
    git_commit: str
    git_user: str

class Tags(Shaper):
    deployed_by: str
    department: str
```

With each of the below stores, notice now that our key space has a schema with validations.

<!-- tabs:start -->

#### **Args**
Key/Value pairs stored under `sntl args` will be made available to docker build as [build args](https://docs.docker.com/engine/reference/commandline/build/#build-arg).

```shell
> sntl args read

 field          value   validation       description  
 ───────────────────────────────────────────────────── 
  github_token   None    field required   None         
  git_commit     None    field required   None         
  git_user       None    field required   None 
```

#### **Envs**
Key/Value pairs stored under `sntl envs` will be made available in the deployed lambda environment variables.

```shell
> sntl envs read

  field         value   validation       description  
 ──────────────────────────────────────────────────── 
  db_hostname   None    field required   None         
  db_port       None    field required   None         
  db_username   None    field required   None         
  db_password   None    field required   None         
```

#### **Tags**
Key/Value pairs stored under `sntl tags` will be used to tag all resources generated by `sntl deploy`.

```shell
> sntl tags read

  field         value   validation       description  
 ──────────────────────────────────────────────────── 
  deployed_by   None    field required   None         
  department    None    field required   None         
```

<!-- tabs:end -->

Adding descriptions is left as an [exercise for the reader](https://docs.pydantic.dev/usage/schema/#field-customization).

### cleanup

```shell
> sntl args clear
> sntl envs clear
> sntl tags clear
```

### further reading
- [pydantic](https://docs.pydantic.dev)
- [validators](https://docs.pydantic.dev/usage/validators/)
